{% extends 'base.html' %}
{% block content %}
<div class="container py-5">
  <h2 class="mb-4">Video Chat</h2>
  <div class="card p-4">
    <div id="video-chat-area" class="mb-3">
      <video id="localVideo" autoplay muted playsinline class="border rounded w-100 mb-2" style="max-height:300px;"></video>
      <video id="remoteVideo" autoplay playsinline class="border rounded w-100" style="max-height:300px;"></video>
    </div>
    <div class="d-flex gap-2">
      <button id="startCallBtn" class="btn btn-success">Start Call</button>
      <button id="endCallBtn" class="btn btn-danger">End Call</button>
    </div>
    <div id="status" class="mt-3 text-muted"></div>
  </div>
</div>
<script>
// Basic WebRTC placeholder
let localStream, remoteStream, peerConnection;
const servers = { iceServers: [{ urls: 'stun:stun.l.google.com:19302' }] };
const localVideo = document.getElementById('localVideo');
const remoteVideo = document.getElementById('remoteVideo');
const startCallBtn = document.getElementById('startCallBtn');
const endCallBtn = document.getElementById('endCallBtn');
const statusDiv = document.getElementById('status');

startCallBtn.onclick = async () => {
  statusDiv.textContent = 'Starting local video...';
  localStream = await navigator.mediaDevices.getUserMedia({ video: true, audio: true });
  localVideo.srcObject = localStream;
  statusDiv.textContent = 'Local video started. (Demo only, no signaling)';
  // In production, signaling server and peer connection setup required
};
endCallBtn.onclick = () => {
  if (localStream) {
    localStream.getTracks().forEach(track => track.stop());
    localVideo.srcObject = null;
    statusDiv.textContent = 'Call ended.';
  }
};
</script>
{% endblock %}
